name: Update ZipZAP M3U
on:
  schedule:
    # Her gÃ¼n Ã¶ÄŸlen 12:00 UTC'de Ã§alÄ±ÅŸÄ±r
    - cron: '0 12 * * *'
  workflow_dispatch:
    # Depo sayfasÄ±ndan manuel olarak Ã§alÄ±ÅŸtÄ±rmaya izin verir

jobs:
  update-m3u:
    permissions:
      contents: write # ğŸ‘ˆ BU SATIR, DOSYAYI DEPONUZA YAZMA Ä°ZNÄ° VERÄ°R (403/128 HATASINI Ã‡Ã–ZER)
    runs-on: ubuntu-latest
    steps:
      - name: â¬‡ï¸ Depoyu Ã‡ek
        uses: actions/checkout@v4

      - name: ğŸ“¦ M3U Ä°Ã§eriÄŸini Worker URL'den Ã‡ekme
        id: fetch_m3u
        run: |
          # DÄ°KKAT: AÅŸaÄŸÄ±daki URL'yi kendi Worker URL'niz ile deÄŸiÅŸtirin
          WORKER_URL="http://smart.aio-digital.workers.dev/TV.php?ID=https://zipzaptv.com/"
          
          # curl komutuna bir User-Agent eklenerek Ã§ekim denenecek
          curl -sS -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64)" "$WORKER_URL" > ZipZAP.m3u
          
      - name: âš™ï¸ DeÄŸiÅŸiklik Var mÄ± Kontrol Et
        id: git_status
        # ZipZAP.m3u dosyasÄ±nda bir deÄŸiÅŸiklik olup olmadÄ±ÄŸÄ±nÄ± kontrol eder
        run: echo "changes=$(git status --porcelain ZipZAP.m3u)" >> $GITHUB_OUTPUT

      - name: â¬†ï¸ DeÄŸiÅŸiklikleri Kaydet (Commit) ve GÃ¶nder (Push)
        # Sadece deÄŸiÅŸiklik varsa commit ve push yapar
        if: ${{ steps.git_status.outputs.changes != '' }}
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "action@github.com"
          git add ZipZAP.m3u
          git commit -m "Auto update: Fetch latest ZipZAP M3U from Worker"
          git push
