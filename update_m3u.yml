name: Update ZipZAP M3U
on:
  schedule:
    # Her g√ºn √∂ƒülen 12:00 UTC'de √ßalƒ±≈üƒ±r
    - cron: '0 12 * * *'
  workflow_dispatch:
    # ƒ∞steƒüe baƒülƒ±: Depo sayfasƒ±ndan manuel olarak √ßalƒ±≈ütƒ±rmaya izin verir

jobs:
  update-m3u:
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Depoyu √áek
        uses: actions/checkout@v4

      - name: üì¶ M3U ƒ∞√ßeriƒüini Worker URL'den √áekme
        id: fetch_m3u
        run: |
          # Dƒ∞KKAT: A≈üaƒüƒ±daki URL'yi kendi Worker URL'niz ile deƒüi≈ütirin
          WORKER_URL="http://smart.aio-digital.workers.dev/TV.php?ID=https://zipzaptv.com/"
          
          # Worker'dan gelen i√ßeriƒüi bir dosyaya kaydet
          curl -sS "$WORKER_URL" > ZipZAP.m3u
          
      - name: ‚öôÔ∏è Deƒüi≈üiklik Var mƒ± Kontrol Et
        id: git_status
        run: echo "changes=$(git status --porcelain)" >> $GITHUB_OUTPUT

      - name: ‚¨ÜÔ∏è Deƒüi≈üiklikleri Kaydet (Commit) ve G√∂nder (Push)
        if: ${{ steps.git_status.outputs.changes != '' }}
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "action@github.com"
          git add ZipZAP.m3u
          git commit -m "Auto update: Fetch latest ZipZAP M3U from Worker"
          git push